!function(){var a=window.mtd3||{};window.mtd3=a,a.components={},a.charts={},a.helpers={},a.helpers.sortNumber=function(a,b){return a-b},a.helpers.objIsArray=function(a){var b="[object Array]"===Object.prototype.toString.call(a)?!0:!1;return b},a.helpers.isNotUndefined=function(a){return"undefined"!=typeof a},a.helpers.degreesToRadians=function(a){return Math.PI*a/180},a.helpers.valueIsBtwZeroAndOne=function(a){if(a>=0&&1>=a)return!0;throw new Error("Value must be between 0 and 1")},a.helpers.addUniqueElemToArray=function(b){if(1!==arguments.length)throw new Error("Function only accepts one argument");if(!a.helpers.objIsArray(this))throw new Error("Function only accepts one argument of type Array");-1===this.indexOf(b)&&this.push(b)},a.helpers.indexOfForObjectArrayByProperty=function(a,b,c){return a.map(function(a){return a[b]}).indexOf(c)},a.helpers.calculateSvgTextWidth=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("version","1.1"),b.setAttribute("xmlns","http://www.w3.org/2000/svg"),b.setAttribute("visibility","hidden"),b.appendChild(a[0][0].cloneNode(!0)),document.body.appendChild(b),d3.select(b).select("text").style("font-size",a.style("font-size"));var c=d3.select(b).select("text").node().getComputedTextLength();return document.body.removeChild(b),Math.round(1.15*c)},a.components.Legend=function(){function a(i){return i.each(function(j){function k(){var a=m.selectAll("g.mtd3.legend").data([j]);return a.enter().append("svg:g").attr("class","mtd3 legend").attr("transform","translate("+b.left+","+b.top+")").append("g"),a.select("g")}function l(){function a(){var a=n.selectAll("g.series").data(j);i=a.enter().append("svg:g").attr("class","series"),i.append("svg:circle").attr("r",7).style("fill",function(a){return a.color}).on("click",function(a,b){g.legendClick(a,b)}),i.append("svg:text").text(function(a){return a.name}).attr("text-anchor","start").attr("dy",".32em").attr("dx","8"),h&&a.classed("disabled",function(a){return a.disabled}),a.exit().remove()}function b(){var a=[];i.each(function(){var b=0,g=0;a.push(d3.select(this).select("text").node().getComputedTextLength()+f),i.attr("transform",function(d,e){function h(d){for(var e,f=0,h=g;d>h;h++)f+=a[h];return e=f+a[d]>c,e?(b++,g+=h,0):f}function i(){return b*f}return"translate("+h(e)+","+i()+")"}),d=(b+1)*e})}var i;a(),b()}var m=d3.select(this);if(a.update=function(){a(i)},a.container=this,j||j.length){var n=k();l()}}),a}var b={top:0,right:0,bottom:0,left:0},c=960-b.right-b.left,d=20-b.top-b.bottom,e=21,f=23,g=d3.dispatch("legendClick"),h=!1;return a.dispatch=g,a.margin=function(c){return arguments.length?(b=c,a):b},a.height=function(b){return arguments.length?(d=b,a):d},a.width=function(b){return arguments.length?(c=b,a):c},a.useSeriesCirclesAsBtns=function(a){return arguments.length?(h=a,void 0):h},a},a.components.Controls=function(){function b(a){return a.each(function(a){function c(){return a.map(function(a){return{name:a.name,color:e,disabled:a.disabled}})}function f(a){h.datum(a).call(d)}function g(){d.dispatch.on("legendClick",function(a){a.disabled=!a.disabled,d.update()})}var h=d3.select(this);if(b.container=this,a||a.length){var i=c();f(i),g()}}),b}var c,d=a.components.Legend(),e="black";return d3.rebind(b,d,"margin","height","width","useSeriesCirclesAsBtns"),b.update=function(){d.update()},b.buttonColor=function(a){return arguments.length?(e=a,b):e},b.onClickFn=function(a){if(!arguments.length)return c;if("function"!=typeof a)throw new Error("argument is not a function. Must be a function");return c=a,b},b},a.components.Polygon=function(b){function c(b){return b.each(function(b){function c(){var a=parseInt(v.style("width"),10),b=parseInt(v.style("height"),10),c=2*e;if(c>a||c>b)throw new Error("radius*2 exceeds container size.");p=b}function q(){for(var a=[],b=j*(Math.PI/180),c=1;d>=c;c++){var h=2*Math.PI*c/d,i=e*Math.cos(h+b)+f,k=e*Math.sin(h+b)+g;a.push({x:i,y:k})}return a}function r(a){var b=a.map(function(a){return a.x+","+a.y});return b.join(" ")}function s(){}function t(){return v.append("g").attr("class","mtd3 polygon").attr("transform","translate("+h+","+i+") scale(1, -1)")}function u(a){y.append("svg:polygon").style("fill",l).style("fill-opacity",k).style("stroke",m).style("stroke-opacity",n).style("stroke-width",o).attr("points",a)}var v=d3.select(this);c();var w=a.helpers.isNotUndefined(b)?b:q(),x=r(w);h&&i||s();var y=t();u(x)}),c}a.helpers.isNotUndefined(b)||(b={});var d=a.helpers.isNotUndefined(b.numSides)?b.numSides:3,e=a.helpers.isNotUndefined(b.radius)?b.radius:1,f=0,g=0,h=0,i=0,j=0,k=1,l="black",m="black",n=1,o=1,p=0;return c.rotationAngle=function(a){return arguments.length?(j=a,c):j},c.fillColor=function(a){return arguments.length?(l=a,c):l},c.fillOpacity=function(b){return arguments.length?(a.helpers.valueIsBtwZeroAndOne(b)&&(k=b),c):k},c.strokeColor=function(a){return arguments.length?(m=a,c):m},c.strokeOpacity=function(b){return arguments.length?(a.helpers.valueIsBtwZeroAndOne(b)&&(n=b),c):n},c.xOffset=function(b){return arguments.length?(a.helpers.valueIsBtwZeroAndOne(b)&&(h=b),c):h},c.yOffset=function(b){return arguments.length?(a.helpers.valueIsBtwZeroAndOne(b)&&(i=b),c):i},c.strokeWidth=function(a){return arguments.length?(o=a,c):o},c},a.components.Tooltip=function(){function a(){if(!g){var a=document.createElement("div");a.className="mtd3tooltip";var b=document.getElementsByTagName("body")[0];b.appendChild(a),g=d3.select(a)}}function b(){g||a(),g.transition().duration(f).style("opacity",1)}function c(){g.transition().duration(f).style("opacity",0)}function d(a){a||(a="tooltip text"),g.text(a).style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-12+"px").style("width",e(a))}function e(a){return 10*a.length+"px"}var f=500,g=null;return{revealTooltip:b,hideTooltip:c,setTooltip:d}}(),a.charts.HorizontalPercentOverTimeBarChart=function(){function b(j){return j.each(function(r){function s(){var b=d3.map(),c=[],d=[];return r.forEach(function(e){var f=e.color?e.color:o(e.name);d.push({name:e.name,color:f}),e.data.forEach(function(d){var e=d.groupData.map(function(b){return a.helpers.addUniqueElemToArray.call(c,b.date),{date:b.date,percent:b.percent,color:f}}),g=d.groupName;if(b.has(g)){var h=b.get(g);b.set(g,h.concat(e))}else b.set(g,e)})}),{dataOrganizedByGroupName:b.entries(),uniqueDates:c,legendData:d}}function t(){var a=F.selectAll("g.mtd3.horiz-percent-bars-graph").data([r]);return a.enter().append("svg:g").attr("class","mtd3 horiz-percent-bars-graph").attr("transform","translate("+d.left+","+d.top+")").append("g"),a.select("g")}function u(a,b){return I.append("svg:g").attr("class","chart").attr("transform","translate("+a+","+b+")")}function v(a){M.append("svg:g").attr("class","x axis"),g=d3.scale.ordinal().rangePoints([0,G],2).domain(a);var b=d3.svg.axis().scale(g).orient("top"),c=M.selectAll(".x.axis").transition().duration(i).call(b);c.selectAll("text").attr("x",-(g()/2))}function w(a){var b=a*h*1.6;M.append("svg:g").attr("class","y axis").append("svg:line").attr("y1","0").attr("y2",b)}function x(b){M.append("svg:g").attr("class","bars-wrap").attr("transform","translate(0,5)");var d=M.select("g.bars-wrap").selectAll("g.data-bars-group").data(b),e=d.enter().append("svg:g").attr("class",function(a,b){var c="data-bars-group",d=p.indexOf(b)>-1;return d&&(c+=" highlighted"),c}).attr("transform",function(a,b){return"translate(0,"+1.4*h*b+")"});e.append("svg:text").attr("x",-6).attr("y",h/2).attr("dy",".35em").attr("text-anchor","end").text(function(a){return a.key}),l&&e.on("mouseover",a.components.Tooltip.revealTooltip).on("mousemove",function(b){return a.components.Tooltip.setTooltip(b.key)}).on("mouseout",a.components.Tooltip.hideTooltip);var f=e.selectAll(".interval-data-bars").data(function(a){var b=y(a);return b});f.enter().append("svg:g").attr("class","data-bar").attr("transform",function(a,b){return"translate("+A(a,b)+",0)"}),f.append("svg:rect").attr("height",h).style("fill",function(a){return a.color}).attr("width",0).transition().duration(i).attr("width",function(a){return B(a.percent)}),c=f.append("svg:text").attr("y",h/1.5).attr("x",function(a){return B(a.percent)/2}).attr("text-anchor","middle").text(function(a){return d3.format("%")(a.percent)})}function y(a){return a.value.sort(function(a,b){var c=J.uniqueDates.indexOf(a.date),d=J.uniqueDates.indexOf(b.date);return d>c?-1:c>d?1:z(a,b)})}function z(b,c){var d=a.helpers.indexOfForObjectArrayByProperty(J.legendData,"color",b.color),e=a.helpers.indexOfForObjectArrayByProperty(J.legendData,"color",c.color);return e>d?-1:d>e?1:0}function A(a,b){var c=0;return 0===b&&(q=0),c=q,q+=B(a.percent),c}function B(a){return a*g()}function C(b,c){var d=[{name:"Toggle Percent Labels",disabled:!1}];I.append("svg:g").attr("class","controlsWrap").attr("transform","translate("+b+","+c+")"),n=a.components.Controls().width(G).useSeriesCirclesAsBtns(!0),I.select(".controlsWrap").datum(d).call(n);var e=1.7*n.height();return H-=e,e}function D(b){var c=a.components.Legend().width(G);I.append("svg:g").attr("class","legendWrap"),I.select(".legendWrap").datum(b).call(c);var d=1.7*c.height();return H-=d,d}function E(){n.onClickFn(function(a){function b(a){switch(a){case!0:c.classed("hidden",!0);break;case!1:c.classed("hidden",!1)}}switch(a.name){case"Toggle Percent Labels":b(a.disabled)}})}var F=d3.select(this),G=(e||parseInt(F.style("width"),10)||960)-d.left-d.right,H=(f||parseInt(F.style("height"),10)||500)-d.top-d.bottom;if(b.update=function(){b(j)},b.container=this,r||r.length){var I=t(),J=s(),K=k?D(J.legendData):0,L=m?C(0,K):0,M=u(0,K+L);v(J.uniqueDates),w(J.dataOrganizedByGroupName.length),x(J.dataOrganizedByGroupName),m&&E()}}),b}var c,d={top:30,right:40,bottom:20,left:50},e=null,f=null,g=d3.scale.ordinal().rangePoints([0,e],2),h=20,i=750,j=25,k=!0,l=!0,m=!0,n=null,o=d3.scale.category20(),p=[],q=0;return b.margin=function(a){return arguments.length?(d=a,b):d},b.width=function(a){return arguments.length?(e=a,b):e},b.height=function(a){return arguments.length?(f=a,b):f},b.barHeight=function(a){return arguments.length?(h=a,b):h},b.duration=function(a){return arguments.length?(i=a,b):i},b.delay=function(a){return arguments.length?(j=a,b):j},b.colorPalette=function(a){return arguments.length?(o=a,b):o},b.tooltips=function(a){return arguments.length?(l=a,b):l},b.showLegend=function(a){return arguments.length?(k=a,b):k},b.showControls=function(a){return arguments.length?(m=a,b):m},b.highlightedRows=function(a){return arguments.length?(a instanceof Array&&(p=a),b):p},b.groupSegmentLength=function(){return g()},b},a.charts.MultiBoxWhiskerChart=function(){function a(c){return c.each(function(p){function q(){var a=F.selectAll("g.mtd31920").data([p]);return a.enter().append("svg:g").attr("class","mtd3 box-whisker-graph").attr("transform","translate("+b.left+","+b.top+")").append("g"),a.select("g")}function r(a,b){var c=H.selectAll("g.chart").data([p]);return c.enter().append("svg:g").attr("class","chart").attr("transform","translate("+a+","+b+")"),c}function s(){var a,b,c,d,e;return p.map(function(f){var j={quartileData:[],whiskerData:[],outlierIndices:[],label:null};if(f instanceof Array){if(f=f.map(g).sort(d3.ascending),a=d3.select(this),b=f.length,c=f[0],d=f[b-1],!(i instanceof Function))throw new Error("invalid data type for quartiles (must be Function)");if(j.quartileData=f.quartiles=i(f),!(h instanceof Function))throw new Error("invalid data type for whiskers (must be Function)");e=h&&h.call(this,f),j.whiskerData=e&&e.map(function(a){return f[a]}),j.outlierIndices=e?d3.range(0,e[0]).concat(d3.range(e[1]+1,b)):d3.range(b)}else{if(!(f instanceof Object&&f.min&&f.max&&f.q1&&f.q2&&f.q3))throw new Error("Invalid data format");a=d3.select(this),c=f.min,d=f.max,j.quartileData=[f.q1,f.q2,f.q3],j.whiskerData=[f.min,f.max],f.label&&(j.label=f.label)}return j})}function t(){j=20;var a=I.selectAll("g.box-whisker-plot").data(J);a.enter().append("svg:g").attr("class","box-whisker-plot").attr("transform",function(a,b){var c=b*k;return"translate("+c+",0)"}),a.exit().remove(),a.each(function(a,b){u(d3.select(this),a,b)})}function u(a,b,c){v(b,c),b.label&&w(a,b),x(a,b.whiskerData),y(a,b.quartileData),z(a,b.quartileData),A(a,b.whiskerData),B(a,b.outlierIndices),C(a,b)}function v(a,b){o=d3.scale.linear().domain(f(a,b)).range([G,0]),n=m[b]||d3.scale.linear().domain([0,1/0]).range(o.range()),m[b]=o}function w(a,b){var c=function(){return o(b.whiskerData[1])-20},d=a.selectAll("text.label").data([b.label]||[]);d.enter().append("text").attr("class","label").attr("dy",".3em").attr("dx",6).attr("x",-8).attr("y",n).text(function(a){return a}).style("opacity",1e-6).transition().duration(e).attr("y",c).style("opacity",1),d.transition().duration(e).text(function(a){return a}).attr("y",c).style("opacity",1),d.exit().transition().duration(e).attr("y",c).style("opacity",1e-6).remove()}function x(a,b){var c=a.selectAll("line.center").data(b?[b]:[]);c.enter().insert("line","rect").attr("class","center").attr("x1",j/2).attr("y1",function(a){return n(a[0])}).attr("x2",j/2).attr("y2",function(a){return n(a[1])}).style("opacity",1e-6).transition().duration(e).style("opacity",1).attr("y1",function(a){return o(a[0])}).attr("y2",function(a){return o(a[1])}),c.transition().duration(e).style("opacity",1).attr("y1",function(a){return o(a[0])}).attr("y2",function(a){return o(a[1])}),c.exit().transition().duration(e).style("opacity",1e-6).attr("y1",function(a){return o(a[0])}).attr("y2",function(a){return o(a[1])}).remove()}function y(a,b){var c=a.selectAll("rect.box").data([b]);c.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(a){return n(a[2])}).attr("width",j).attr("height",function(a){return n(a[0])-n(a[2])}).transition().duration(e).attr("y",function(a){return o(a[2])}).attr("height",function(a){return o(a[0])-o(a[2])}),c.transition().duration(e).attr("y",function(a){return o(a[2])}).attr("height",function(a){return o(a[0])-o(a[2])})}function z(a,b){var c=a.selectAll("line.median").data([b[1]]);c.enter().append("line").attr("class","median").attr("x1",0).attr("y1",n).attr("x2",j).attr("y2",n).transition().duration(e).attr("y1",o).attr("y2",o),c.transition().duration(e).attr("y1",o).attr("y2",o)}function A(a,b){var c=a.selectAll("line.whisker").data(b||[]);c.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",n).attr("x2",j).attr("y2",n).style("opacity",1e-6).transition().duration(e).attr("y1",o).attr("y2",o).style("opacity",1),c.transition().duration(e).attr("y1",o).attr("y2",o).style("opacity",1),c.exit().transition().duration(e).attr("y1",o).attr("y2",o).style("opacity",1e-6).remove()}function B(a,b){var c=a.selectAll("circle.outlier").data(b,Number);c.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",j/2).attr("cy",function(a,b){return n(a[b])}).style("opacity",1e-6).transition().duration(e).attr("cy",function(a,b){return o(a[b])}).style("opacity",1),c.transition().duration(e).attr("cy",function(a,b){return o(a[b])}).style("opacity",1),c.exit().transition().duration(e).attr("cy",function(a,b){return o(a[b])}).style("opacity",1e-6).remove()}function C(a,b){var c=l||o.tickFormat(8);D(a,c,b.quartileData),E(a,c,b.whiskerData)}function D(a,b,c){var d=a.selectAll("text.box").data(c);d.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(a,b){return 1&b?6:-6}).attr("x",function(a,b){return 1&b?j:0}).attr("y",n).attr("text-anchor",function(a,b){return 1&b?"start":"end"}).text(b).transition().duration(e).attr("y",o),d.transition().duration(e).text(b).attr("y",o)}function E(a,b,c){var d=a.selectAll("text.whisker").data(c||[]);d.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",j).attr("y",n).text(b).style("opacity",1e-6).transition().duration(e).attr("y",o).style("opacity",1),d.transition().duration(e).text(b).attr("y",o).style("opacity",1),d.exit().transition().duration(e).attr("y",o).style("opacity",1e-6).remove()}var F=d3.select(this),G=(d||parseInt(F.style("height"),10)||500)-b.top-b.bottom;if(a.update=function(){a(c)},a.container=this,p||p.length){var H=q(),I=r(0,0),J=s();t()}}),a}var b={top:30,right:10,bottom:10,left:50},c=null,d=null,e=0,f=null,g=Number,h=[0,0],i=[0,0,0],j=null,k=110,l=null,m=[],n=null,o=null;return a.margin=function(c){return arguments.length?(b=c,a):b},a.width=function(b){return arguments.length?(c=b,a):c},a.height=function(b){return arguments.length?(d=b,a):d},a.tickFormat=function(b){return arguments.length?(l=b,a):l},a.duration=function(b){return arguments.length?(e=b,a):e},a.domain=function(b){return arguments.length?(f=null===b?b:d3.functor(b),a):f},a.value=function(b){return arguments.length?(g=b,a):g},a.whiskers=function(b){return arguments.length?(h=b,a):h},a.quartiles=function(b){return arguments.length?(i=b,a):i},a.spacingBetweenBoxPlots=function(b){return arguments.length&&"number"==typeof b?(k=b,a):k},a},a.charts.ParallelCoordinatesChart=function(){function b(r){return r.each(function(s){function t(){var a=M.selectAll("g.mtd3.parallel-coords-graph").data([s]);return a.enter().append("svg:g").attr("class","mtd3 parallel-coords-graph").attr("transform","translate("+c.left+","+c.top+")").append("g"),a.select("g")}function u(){return s.map(function(a){return{name:a.name,color:L(a)}})}function v(b){var c=a.components.Legend().width(N);P.append("svg:g").attr("class","legendWrap"),P.select(".legendWrap").datum(b).call(c);var d=1.7*c.height();return O-=d,d}function w(b,c){var d=[{name:"Clear All Brushes",disabled:!1}];P.append("svg:g").attr("class","controlsWrap").attr("transform","translate("+b+","+c+")"),n=a.components.Controls().width(N).useSeriesCirclesAsBtns(!0),P.select(".controlsWrap").datum(d).call(n);var e=1.7*n.height();return O-=e,e}function x(){n.onClickFn(function(a){switch(a.name){case"Clear All Brushes":j.selectAll("g.brush").remove(),F()}})}function y(a,b){var c=P.append("svg:g").attr("class","chart").attr("transform","translate("+a+","+b+")");return c}function z(){f=d3.scale.ordinal().rangePoints([0,N],1),f.domain(h=d3.keys(s[0]).filter(function(a){var b="name"!==a&&"mtd3-color"!==a;return b?b&&(i[a]=A(a)):void 0}))}function A(a){var b=s[0][a];return"string"==typeof b?B(a):C(a)}function B(a){return d3.scale.ordinal().domain(s.map(function(b){return b[a]})).rangePoints([O,0])}function C(a){return d3.scale.linear().domain(d3.extent(s,function(b){return+b[a]})).range([O,0])}function D(){o=T.append("svg:g").attr("class","background").selectAll("path").data(s).enter().append("svg:path").attr("d",K),p=T.append("svg:g").attr("class","foreground").selectAll("path").data(s).enter().append("svg:path").attr("d",K).style("stroke",function(a){return L(a)})}function E(){function a(a){return a.transition().duration(500)}j=T.selectAll(".dimension").data(h).enter().append("svg:g").attr("class","dimension").attr("transform",function(a){return"translate("+f(a)+")"}).call(d3.behavior.drag().on("dragstart",function(a){k[a]=this.__origin__=f(a),o.attr("visibility","hidden")}).on("drag",function(a){k[a]=Math.min(N,Math.max(0,this.__origin__+=d3.event.dx)),p.attr("d",K),h.sort(function(a,b){return J(a)-J(b)}),f.domain(h),j.attr("transform",function(a){return"translate("+J(a)+")"})}).on("dragend",function(b){delete this.__origin__,delete k[b],a(d3.select(this)).attr("transform","translate("+f(b)+")"),a(p).attr("d",K),o.attr("d",K).transition().delay(500).duration(0).attr("visibility",null)})),j.append("svg:g").attr("class","axis").each(function(a){var b=d3.svg.axis().orient("left");d3.select(this).call(b.scale(i[a]))}).append("svg:text").attr("text-anchor","middle").attr("y",-9).text(String),F()}function F(){j.append("svg:g").attr("class","brush").each(function(a){d3.select(this).call(i[a].brush=d3.svg.brush().y(i[a]).on("brush",G))}).selectAll("rect").attr("x",-8).attr("width",16),G()}function G(){q=h.filter(function(a){return!i[a].brush.empty()});var a=q.map(function(a){return i[a].brush.extent()});H(a)}function H(a){p.style("display",function(b){return q.every(function(c,d){var e="number"==typeof b[c]?b[c]:i[c](b[c]);return I(a[d],e)})?null:"none"})}function I(a,b){return a[0]<=b&&b<=a[1]}function J(a){var b=k[a];return null===b?f(a):b}function K(a){var b=d3.svg.line();return b(h.map(function(b){return[J(b),i[b](a[b])]}))}function L(a){return a["mtd3-color"]?a["mtd3-color"]:g(a)}var M=d3.select(this),N=(d||parseInt(M.style("width"),10)||960)-c.left-c.right,O=(e||parseInt(M.style("height"),10)||500)-c.top-c.bottom;if(b.update=function(){b(r)},b.container=this,s||s.length){var P=t(),Q=u(),R=l?v(Q):0,S=m?w(0,R):0,T=y(0,R+S);z(),D(),E(),m&&x()}}),b}var c={top:30,right:10,bottom:10,left:10},d=null,e=null,f=null,g=d3.scale.category20(),h=null,i={},j=null,k={},l=!1,m=!0,n=null,o=null,p=null,q=[];return b.margin=function(a){return arguments.length?(c=a,b):c},b.width=function(a){return arguments.length?(d=a,b):d},b.height=function(a){return arguments.length?(e=a,b):e},b.colorPalette=function(a){return arguments.length?(g=a,b):g},b.showLegend=function(a){return arguments.length?(l=a,b):l},b.showControls=function(a){return arguments.length?(m=a,b):m},b},a.charts.SpiderViewChart=function(){function b(o){return o.each(function(p){function q(){var a=N.selectAll("g.mtd3.spiderview-graph").data([p]);return a.enter().append("svg:g").attr("class","mtd3 spiderview-graph").attr("transform","translate("+c.left+","+c.top+")").append("g"),a.select("g")}function r(){Q.append("svg:g").attr("class","legendWrap");var b=a.components.Legend().width(O).margin({top:11,bottom:0,left:O/3.5,right:0}),c=p.map(function(a){return{name:a.name,color:M(a)}});Q.select(".legendWrap").datum(c).call(b);var d=1.7*b.height();return P-=d,d}function s(a,b){var c=Q.append("svg:g").attr("class","chart").attr("transform","translate("+a+","+b+")");return c}function t(){u(),v()}function u(){i=d3.keys(p[0]).filter(function(a){return L(a)})}function v(){m?w():i.forEach(function(a){y(a)})}function w(){var a=x();j[n]=z(a)}function x(){return p.reduce(function(a,b){var c=i.map(function(a){return+b[a]});return a.concat(c)},[]).sort(a.helpers.sortNumber)}function y(b){var c=p.map(function(a){return+a[b]}).sort(a.helpers.sortNumber);j[b]=z(c)}function z(a){return d3.scale.ordinal().domain(a).rangeBands([0,f],1)}function A(){var a=360/i.length;i.forEach(function(b,c){k[b]=(c+1)*a})}function B(){var a=S.append("g").attr("class","dimensions").selectAll("g.axis").data(i).enter().append("g").attr("class","axis").attr("transform",function(a){return"rotate("+k[a]+" 0 0)"}).each(function(a){var b=J(a),c=d3.svg.axis().scale(b).orient("top");d3.select(this).call(c)});a.append("g").attr("class","axis-label").attr("transform","translate("+1.04*f+")").append("text").attr("text-anchor",function(a){var b=k[a];return 90===b||270===b?"middle":b>90&&270>b?"end":"start"}).attr("transform",function(a){return"rotate("+(360-k[a])+" 0 0)"}).text(function(a){return a})}function C(){function b(){for(var b=S.append("g").attr("class","gridlines"),c=D(),e=j[c],f=0;f<=e.domain().length;f++){var g=e.range()[f],h=a.components.Polygon({numSides:i.length,radius:g}).strokeColor("grey").fillOpacity(0).strokeOpacity(.3).strokeWidth(1.5),k=b.append("g").attr("class","gridline");d(k,h)}}function c(){var b=a.components.Polygon({numSides:i.length,radius:f}).fillOpacity(0).strokeWidth(2),c=S.append("g").attr("class","border");d(c,b)}function d(a,b){a.datum(null).transition().duration(l).call(b)}b(),c()}function D(){return m?n:E()}function E(){return i.reduce(function(a,b){var c=j[b].domain().length,d=j[a].domain().length;return c>d?b:a})}function F(){var a=G();K(a)}function G(){return p.map(function(a){return{coords:H(a),color:M(a)}})}function H(b){return d3.keys(b).filter(L).map(function(c){var d=I(c,b),e=k[c],f=a.helpers.degreesToRadians(e);return{x:d*Math.cos(f),y:d*Math.sin(f)}})}function I(a,b){var c=J(a);return c(b[a])}function J(a){return m?j[n]:j[a]}function K(b){var c=S.append("g").attr("class","spiders");c.selectAll("g.spider").data(b).enter().append("g").attr("class","spider").each(function(b){var c=a.components.Polygon().fillOpacity(.3).fillColor(b.color).strokeColor(b.color).strokeWidth(1);d3.select(this).datum(b.coords).transition().duration(l).call(c)})}function L(a){return"name"!==a&&"mtd3-color"!==a}function M(a){return a["mtd3-color"]?a["mtd3-color"]:h(a.name)}var N=d3.select(this),O=(d||parseInt(N.style("width"),10)||960)-c.left-c.right,P=(e||parseInt(N.style("height"),10)||500)-c.top-c.bottom;if(b.update=function(){b(o)},b.container=this,p||p.length){f=f?f:.45*Math.min(O,P);var Q=q(),R=g?r():0,S=s(O/2,R+P/2);t(),A(),B(),C(),F()}}),b}var c={top:0,right:0,bottom:0,left:0},d=null,e=null,f=null,g=!0,h=d3.scale.category20(),i=[],j={},k={},l=1200,m=!1,n=0;return b.margin=function(a){return arguments.length?(c=a,b):c},b.width=function(a){return arguments.length?(d=a,b):d},b.height=function(a){return arguments.length?(e=a,b):e},b.radius=function(a){return arguments.length?(f=a,b):f},b.colorPalette=function(a){return arguments.length?(h=a,b):h},b.showLegend=function(a){return arguments.length?(g=a,b):g},b.animationDuration=function(a){return arguments.length?(l=a,b):l},b.sameDimensionScale=function(a){return arguments.length?(m=a,b):m},b},a.charts.LineChart=function(){function b(o){return o.each(function(p){function q(){var a=B.selectAll("g.mtd3.line-graph").data([p]);return a.enter().append("svg:g").attr("class","mtd3 line-graph").attr("transform","translate("+c.left+","+c.top+")").append("g"),a.select("g")}function r(a,b){var c=E.selectAll("g.chart").data([p]);return c.enter().append("svg:g").attr("class","chart").attr("transform","translate("+a+","+b+")"),c}function s(){var a=d3.svg.line().x(function(a){return f(a[j])}).y(function(a){return g(a[k])}),b=F.selectAll(".data-lines").data([p]);b.enter().append("svg:g").attr("class","data-lines");var c=b.selectAll(".line").data(G);c.enter().append("path").attr("class","line").style("stroke-opacity",0).transition().duration(m).style("stroke-opacity",1).attr("d",function(b){return a(b.data)}),c.transition().duration(m).attr("d",function(b){return a(b.data)}),c.exit().transition().duration(m).style("stroke-opacity",0).remove()}function t(){var a=v();w(a)}function u(){var a=d3.merge(G.map(function(a){return a.data})),b=d3.extent(a,function(a){return a[j]});b[1]*=h,f.domain(b).range([0,C]);var c=d3.extent(a,function(a){return a[k]});c[1]*=i,g.domain(c).range([D,0])}function v(){var a=d3.svg.axis().scale(f).orient("bottom"),b=d3.svg.axis().scale(g).orient("left");return{x:a,y:b}}function w(a){x(a.x),y(a.y)}function x(a){var b=F.selectAll(".x-axis").data([p]);b.enter().append("svg:g").attr("class","x-axis axis").attr("transform","translate(0,"+D+")").transition().duration(m).call(a),b.transition().duration(m).call(a)}function y(a){var b=F.selectAll(".y-axis").data([p]);b.enter().append("svg:g").attr("class","y-axis axis").transition().duration(m).call(a),b.transition().duration(m).call(a)}function z(){var a=F.selectAll("g.events").data([H]);a.enter().append("g").attr("class","events");var b=function(a){return f(a[j])},c=a.selectAll(".event").data(H);c.enter().append("line").attr("class","event").attr("x1",b).attr("y1",D).attr("x2",b).attr("y2",D).style("stroke",function(a){return n(a.type)}).transition().duration(m).attr("y2",0);var d=m/4;c.transition().duration(d).attr("y2",D).transition().attr("x1",b).attr("y1",D).attr("x2",b).style("stroke",function(a){return n(a.type)}).transition().duration(d).attr("y2",0),c.exit().transition().duration(m).attr("y2",D).remove(),l&&A(c)}function A(b){b.on("mouseover",a.components.Tooltip.revealTooltip).on("mousemove",function(b,c){var d=l(b,c);return a.components.Tooltip.setTooltip(d)}).on("mouseout",a.components.Tooltip.hideTooltip)}var B=d3.select(this),C=(d||parseInt(B.style("width"),10)||960)-c.left-c.right,D=(e||parseInt(B.style("height"),10)||500)-c.top-c.bottom;if(b.update=function(){b(o)},b.container=this,p||p.length){var E=q(),F=r(0,0),G=p.data||[],H=p.events||[];u(),s(),t(),z()}}),b}var c={top:30,right:10,bottom:20,left:25},d=null,e=null,f=d3.scale.linear(),g=d3.scale.linear(),h=1,i=1,j="x",k="y",l=!1,m=1e3,n=d3.scale.category10();return b.margin=function(a){return arguments.length?(c=a,b):c},b.width=function(a){return arguments.length?(d=a,b):d},b.height=function(a){return arguments.length?(e=a,b):e},b.x=function(a){return arguments.length?(j=a,b):j},b.y=function(a){return arguments.length?(j=a,b):k},b.transitionDuration=function(a){return arguments.length?(m=a,b):m},b.eventTooltips=function(a){return arguments.length?(l=a,b):l},b.xAxisScaleMaxValMultipler=function(a){if(!arguments.length)return h;if(arguments[0]<1)throw new Error("mtd3.charts.LineChart() - xAxisScaleMaxValMultipler cannot be below 1.0");return h=a,b},b.yAxisScaleMaxValMultipler=function(a){if(!arguments.length)return i;if(arguments[0]<1)throw new Error("mtd3.charts.LineChart() - yAxisScaleMaxValMultipler cannot be below 1.0");return i=a,b},b},a.charts.Histogram=function(){function a(h){return h.each(function(j){function k(){var a=d3.layout.histogram();return g&&a.bins(e.ticks(g)),a(j)}function l(){var a=w.selectAll("g.mtd3.histogram-graph").data([j]);return a.enter().append("svg:g").attr("class","mtd3 histogram-graph").attr("transform","translate("+b.left+","+b.top+")").append("g"),a.select("g")}function m(a,b){var c=z.selectAll("g.chart").data([j]);return c.enter().append("svg:g").attr("class","chart").attr("transform","translate("+a+","+b+")"),c}function n(){var a=o()-1,b=a/2,c=A.selectAll(".bars").data([j]);c.enter().append("svg:g").attr("class","bars");var d=c.selectAll(".bar").data(j);d.exit().transition().duration(i).style("fill-opacity",0).remove(),d.transition().duration(i).attr("transform",function(a){return"translate("+e(a.x)+","+f(a.y)+")"}),d.select("rect").attr("height",function(a){return y-f(a.y)}).attr("width",a),d.select("text").attr("x",b).text(p);var g=d.enter().append("svg:g").attr("class","bar").attr("transform",function(a){return"translate("+e(a.x)+","+f(a.y)+")"});g.append("rect").attr("x",1).attr("width",0).attr("height",function(a){return y-f(a.y)}).transition().delay(i).duration(i).attr("width",a),g.append("text").attr("dy",".75em").attr("y",6).attr("x",b).attr("text-anchor","middle").text(p)}function o(){var a=e.domain()[0],b=e.domain()[1];if(a>=0)return e(a+j[0].dx);var c=b+a,d=c/2;return e(j[0].dx)-e(d)}function p(a){return d3.format(",.0f")(a.y)}function q(){var a=t();u(a)}function r(a){var b=d3.min(a),c=d3.max(a);e.domain([b,c]).nice(1).range([0,x])}function s(a){f.domain([0,d3.max(a,function(a){return a.y})]).range([y,0])}function t(){var a=d3.svg.axis().scale(e).orient("bottom");return{x:a}}function u(a){v(a.x)}function v(a){var b=A.selectAll(".x-axis").data([j]);b.enter().append("svg:g").attr("class","x-axis axis").attr("transform","translate(0,"+y+")").transition().duration(i).call(a),b.transition().duration(i).call(a)}var w=d3.select(this),x=(c||parseInt(w.style("width"),10)||960)-b.left-b.right,y=(d||parseInt(w.style("height"),10)||500)-b.top-b.bottom;if(a.update=function(){a(h)},a.container=this,j||j.length){var z=l(),A=m(0,0);r(j),j=k(),s(j),q(),n()}}),a}var b={top:30,right:10,bottom:20,left:25},c=null,d=null,e=d3.scale.linear(),f=d3.scale.linear(),g=null,h=!0,i=1300;return a.margin=function(c){return arguments.length?(b=c,a):b},a.width=function(b){return arguments.length?(c=b,a):c},a.height=function(b){return arguments.length?(d=b,a):d},a.transitionDuration=function(b){return arguments.length?(i=b,a):i},a.ticks=function(b){if(!arguments.length)return g;if("number"!=typeof arguments[0])throw new Error("mtd3.charts.Histogram() - ticks must be of type 'number'");return g=b,a},a.showBinCountLabels=function(b){return arguments.length?(h=b,a):h},a},a.charts.HeatMap=function(){function b(c){return c.each(function(d){function e(){var a=s.selectAll("g.mtd3.heatmap-graph").data([d]);return a.enter().append("svg:g").attr("class","mtd3 heatmap-graph").attr("transform","translate("+g.left+","+g.top+")").append("g"),a.select("g")
}function h(a,b){var c=u.selectAll("g.chart").data([d]);return c.enter().append("svg:g").attr("class","chart").attr("transform","translate("+a+","+b+")"),c}function n(){var a=15,b=t/2*.9,c=v.selectAll(".label").data([d]);c.enter().append("svg:text").attr("class","label").attr("x",0).attr("y",0).attr("transform","translate("+a+","+b+") rotate(-90)").text(function(a){return a.name}),c.attr("transform","translate("+a+","+b+") rotate(-90)").text(function(a){return a.name})}function o(){function a(a,b){if(e>=j){var c=t-e;return e-=j,c}return e=t-j,g+=j,h.push(b),i.push(g),0}var b=v.selectAll(".squares").data([d]);b.enter().append("g").attr("class","squares").attr("transform","translate(20,0)");var c=d.data,e=t,g=0,h=[],i=[],k=d3.scale.quantile();if(h.push(0),i.push(g),b.selectAll(".square").remove(),f=b.selectAll(".square").data(c),f.enter().append("rect").attr("class","square").style("fill",r).attr("width",j).attr("height",j).attr("y",a),g>0&&h.length>=2){var l=h[1]-h[0],m=h.length-1,n=h[m],o=n+l,p=o+l;h.push(o),h.push(p),i.push(g+j)}k.domain(h).range(i),f.attr("x",function(a,b){return k(b)})}function p(){l.forEach(function(a){f.on(a.event,a.callback)})}function q(){f.on("mouseover",a.components.Tooltip.revealTooltip).on("mousemove",function(b,c){var d=m(b,c);return a.components.Tooltip.setTooltip(d)}).on("mouseout",a.components.Tooltip.hideTooltip)}function r(a){return k(a.value)}var s=d3.select(this),t=(i||parseInt(s.style("height"),10)||500)-g.top-g.bottom;if(b.update=function(){b(c)},b.container=this,d||d.length){var u=e(),v=h(0,0);o(),p(l),m&&q(),n()}}),b}function c(a,b){l.push({event:a,callback:b})}function d(){l.forEach(function(a){e(a.event),a=null}),l=[]}function e(a){f.on(a,null)}var f,g={top:0,right:0,bottom:0,left:0},h=null,i=null,j=17,k=d3.scale.linear().domain([0,1]).range(["white","#004D03"]),l=[],m=!1;return b.margin=function(a){return arguments.length?(g=a,b):g},b.width=function(a){return arguments.length?(h=a,b):h},b.height=function(a){return arguments.length?(i=a,b):i},b.colorScaleDomain=function(a){return arguments.length?(k.domain(a),b):k.domain()},b.colorScaleRange=function(a){return arguments.length?(k.range(a),b):k.range()},b.squareSize=function(a){return arguments.length?(j=a,b):j},b.tooltips=function(a){return arguments.length?(m=a,b):m},b.bindEventHandlerToSquares=function(a,d){if(2!==arguments.length)throw new Error("bindEventHandlerToSquares() accepts only 2 arguments: one with the event name, and one for the callback function");return c(a,d),b},b.unbindEventHandlers=function(a){if(0===arguments.length)return d(),b;if(1!==arguments.length)throw new Error("unbindEventHandlers() accepts only 1 argument (event name) or nothing (unbinds all event handlers)");if(f)return e(a),b;throw new Error("squares for HeatMap have not been rendered to the DOM yet")},b}}();